import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { useMemo, useState } from "react";
import { useQuery } from "@tanstack/react-query";
import { AppShell } from "../components/app-shell";
import { apiFetch } from "../lib/api";
const tabs = ["Profile", "API Keys", "Secrets", "Billing", "Danger Zone"];
export function SettingsPage() {
    const [tab, setTab] = useState("Profile");
    const meQuery = useQuery({ queryKey: ["me"], queryFn: () => apiFetch("/api/user/me") });
    const usageQuery = useQuery({ queryKey: ["usage"], queryFn: () => apiFetch("/api/user/usage") });
    const usage = useMemo(() => usageQuery.data, [usageQuery.data]);
    return (_jsx(AppShell, { title: "Settings", subtitle: "Manage your account, API keys, and billing", children: _jsxs("div", { className: "grid gap-4 lg:grid-cols-[220px_1fr]", children: [_jsx("div", { className: "rounded-xl border border-[var(--divider)] bg-[var(--bg-surface)] p-2", children: tabs.map((item) => (_jsx("button", { type: "button", onClick: () => setTab(item), className: `mb-1 w-full rounded-md px-3 py-2 text-left text-sm ${tab === item ? "bg-[var(--bg-inset)] text-[var(--text-primary)]" : "text-[var(--text-secondary)]"}`, children: item }, item))) }), _jsxs("div", { className: "space-y-4", children: [tab === "Profile" ? (_jsxs("section", { className: "rounded-xl border border-[var(--divider)] bg-[var(--bg-surface)] p-4", children: [_jsx("h2", { className: "font-semibold", children: "Profile" }), meQuery.isLoading ? _jsx("p", { className: "mt-2 text-sm text-[var(--text-tertiary)]", children: "Loading profile..." }) : null, meQuery.data ? (_jsxs("dl", { className: "mt-4 grid gap-2 text-sm", children: [_jsxs("div", { children: [_jsx("dt", { className: "text-[var(--text-tertiary)]", children: "Name" }), _jsx("dd", { children: meQuery.data.name || "-" })] }), _jsxs("div", { children: [_jsx("dt", { className: "text-[var(--text-tertiary)]", children: "Email" }), _jsx("dd", { children: meQuery.data.email })] }), _jsxs("div", { children: [_jsx("dt", { className: "text-[var(--text-tertiary)]", children: "Plan" }), _jsx("dd", { className: "capitalize", children: meQuery.data.plan })] })] })) : null] })) : null, tab === "API Keys" ? (_jsxs("section", { className: "rounded-xl border border-[var(--divider)] bg-[var(--bg-surface)] p-4", children: [_jsx("h2", { className: "font-semibold", children: "API Keys" }), _jsx("p", { className: "mt-1 text-sm text-[var(--text-tertiary)]", children: "Manage your API credentials." }), _jsx("button", { type: "button", className: "mt-4 rounded-md border border-[var(--divider)] px-3 py-2 text-sm text-[var(--text-secondary)]", children: "Generate key (coming soon)" })] })) : null, tab === "Secrets" ? (_jsxs("section", { className: "rounded-xl border border-[var(--divider)] bg-[var(--bg-surface)] p-4", children: [_jsx("h2", { className: "font-semibold", children: "Secrets" }), _jsx("p", { className: "mt-1 text-sm text-[var(--text-tertiary)]", children: "Store provider tokens and secure variables." }), _jsx("button", { type: "button", className: "mt-4 rounded-md border border-[var(--divider)] px-3 py-2 text-sm text-[var(--text-secondary)]", children: "Add secret (coming soon)" })] })) : null, tab === "Billing" ? (_jsxs("section", { className: "rounded-xl border border-[var(--divider)] bg-[var(--bg-surface)] p-4", children: [_jsx("h2", { className: "font-semibold", children: "Billing" }), _jsx("p", { className: "mt-1 text-sm text-[var(--text-tertiary)]", children: "Manage billing" }), _jsxs("div", { className: "mt-4 grid grid-cols-2 gap-3 md:grid-cols-4", children: [_jsx(Tile, { label: "Credits used", value: String(usage?.credits_used ?? 0) }), _jsx(Tile, { label: "Credits remaining", value: String(usage?.credits_remaining ?? 0) }), _jsx(Tile, { label: "Runs today", value: String(usage?.runs_today ?? 0) }), _jsx(Tile, { label: "Cost", value: `${((usage?.total_cost_cents ?? 0) / 100).toFixed(2)}â‚¬` })] }), _jsxs("div", { className: "mt-4 rounded-lg border border-[var(--divider)] bg-[var(--bg-inset)] p-3", children: [_jsxs("div", { className: "mb-2 flex items-center justify-between text-sm", children: [_jsx("span", { className: "text-[var(--text-secondary)]", children: "Credit usage" }), _jsx("span", { className: "text-[var(--text-primary)]", children: (usage?.credits_used ?? 0) + (usage?.credits_remaining ?? 0) > 0
                                                        ? `${usage?.credits_used ?? 0} / ${(usage?.credits_used ?? 0) + (usage?.credits_remaining ?? 0)}`
                                                        : "0 / 0" })] }), _jsx("div", { className: "h-2 rounded-full bg-[var(--divider)]", children: _jsx("div", { className: "h-2 rounded-full bg-[var(--accent)]", style: {
                                                    width: (usage?.credits_used ?? 0) + (usage?.credits_remaining ?? 0) > 0
                                                        ? `${(((usage?.credits_used ?? 0) / ((usage?.credits_used ?? 0) + (usage?.credits_remaining ?? 0))) * 100).toFixed(0)}%`
                                                        : "0%",
                                                } }) })] })] })) : null, tab === "Danger Zone" ? (_jsxs("section", { className: "rounded-xl border border-red-500/40 bg-[var(--bg-surface)] p-4", children: [_jsx("h2", { className: "font-semibold text-red-300", children: "Danger Zone" }), _jsx("p", { className: "mt-1 text-sm text-[var(--text-tertiary)]", children: "Permanently delete your account and all pipeline data. This action cannot be undone." }), _jsx("button", { type: "button", className: "mt-4 rounded-md border border-red-500/50 px-3 py-2 text-sm text-red-200 opacity-70", disabled: true, children: "Delete account (unavailable)" })] })) : null] })] }) }));
}
function Tile({ label, value }) {
    return (_jsxs("div", { className: "rounded-lg border border-[var(--divider)] bg-[var(--bg-inset)] p-3", children: [_jsx("p", { className: "text-xs uppercase tracking-wider text-[var(--text-tertiary)]", children: label }), _jsx("p", { className: "mt-1 text-lg font-semibold", children: value })] }));
}
//# sourceMappingURL=settings.js.map